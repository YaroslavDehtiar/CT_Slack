<template>
    <div class="action-search-container slds-grid slds-grid_align-spread">
        <lightning-input type="search" label="Search" class="slds-col action-search-input"
                         value={searchContextActionValue}
                         onchange={handleContextActionsSearch}
                         placeholder="Search for associated actions..."></lightning-input>

        <lightning-button-menu class="new-action-button slds-col"
                               onselect= {handleMenuSelect}
                               alternative-text="Associate Actions"
                               icon-name="utility:add"
                               variant="border-filled"
                               menu-alignment="right"
        >
            <template for:each={actionTypes} for:item="actionType">
                <lightning-menu-item
                        key={actionType.value}
                        value={actionType.value}
                        label={actionType.label}
                ></lightning-menu-item>
            </template>
        </lightning-button-menu>
    </div>

    <!--                ##### LIST OF CONTEXT ACTIONS #####-->
    <c-custom-datatable
            key-field="name"
            data={contextActionsToDisplay}
            columns={contextActionColumns}
            onchangeorder={handleChangeOrder}
            onrowaction={handleContextActionsTableRowAction}
            hide-checkbox-column>
    </c-custom-datatable>

    <!--    ##### POP-UP MODAL FOR CHOOSING ASSOCIATE ACTIONS #####-->
    <c-modal size="small" class="actions-selection-modal">
        <h2 slot="header" class="new-path-modal-header-text slds-text-heading_large">Associate Actions</h2>
        <div slot="body" class="new-path-modal-body">
            <div class="slds-grid slds-grid_align-spread">
                <lightning-input type="search" class="slds-col action-search-input" label="Search"
                                 value={searchActionValue}
                                 placeholder="Search for action name..."
                                 onchange={handleActionsSearch}></lightning-input>

            </div>

            <lightning-datatable class="actions-list"
                    key-field="name"
                    data={filteredActionsToAssociate}
                    columns={actionColumns}
                    onrowselection={getSelectedActionRows}
                    onrowaction={handleActionsTableRowAction}
            >
            </lightning-datatable>
        </div>
        <div slot="footer" class="new-path-modal-footer">
            <lightning-button label="Cancel" onclick={closeActionsModal}></lightning-button>
            <lightning-button label="Save" variant="brand" onclick={createContextActions}></lightning-button>
        </div>
    </c-modal>

    <!--MODAL FOR DISPLAYING ACTION PARAMETERS JSON-->
    <c-modal size="small" class="action-parameters-modal">
        <h2 slot="header" class="new-path-modal-header-text slds-text-heading_large">Action Parameters</h2>
        <div slot="body" class="action-parameters-modal-body">
            <c-json-tree-view json={actionParameters}></c-json-tree-view>
        </div>
        <div slot="footer" class="new-path-modal-footer">
            <lightning-button label="Close" onclick={closeParametersModal}></lightning-button>
        </div>
    </c-modal>
</template>