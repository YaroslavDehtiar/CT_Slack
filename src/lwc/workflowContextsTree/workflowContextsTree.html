<template>
    <div class="dropdown-container">
        <div class='dropdown-menu-header dropdown-menu-item-container'>
            <div class="dropdown-menu-item">
                <h2 class="slds-text-heading_small slds-p-right--small">CONTEXTS</h2>
            </div>
            <lightning-button-icon class="new-context-button" onclick={addContext}
                                   alternative-text="Add new parent Context" icon-name="utility:add"></lightning-button-icon>
        </div>

        <div class='dropdown-submenu-container'>
            <template if:true={contextsLocal}>
                <template for:each={contextsLocal} for:item="context">

                    <div class="dropdown-menu-item-container" key={context.name}>
                        <div class="dropdown-menu-item" onclick={onItemClick} data-name={context.name}>
                            <template if:true={context.hasChildren}>
                                <lightning-icon
                                        icon-name="utility:chevronright"
                                        alternative-text="dropdown indicator"
                                        size="x-small"
                                        data-parentname={context.name}
                                        onclick={handleChildrenVisibility}
                                ></lightning-icon>
                                <lightning-icon
                                        icon-name="utility:chevrondown"
                                        alternative-text="dropdown indicator"
                                        size="x-small"
                                        data-parentname={context.name}
                                        onclick={handleChildrenVisibility}
                                        class="slds-hide"
                                ></lightning-icon>
                            </template>
                            <template if:false={context.hasChildren}>
                                <div class="blank-icon"></div>
                            </template>
                            <h2 class="slds-text-heading_small dropdown-context-title">{context.label}</h2>
                        </div>
                        <lightning-button-icon class="new-context-button" onclick={addContext} alternative-text="Add new child Context"
                                               icon-name="utility:add" data-name={context.name}></lightning-button-icon>
                    </div>

                    <template if:true={context.hasChildren} for:each={context.childContexts} for:item="childContext">
                        <div class="dropdown-menu-item-container dropdown-menu-item slds-hide" onclick={onItemClick}  key={childContext.name} data-name={childContext.name} data-parentname={context.name}>
                            <h2 class="slds-text-heading_small submenu-title">{childContext.label}</h2>
                        </div>
                    </template>
                </template>
            </template>
        </div>
    </div>
</template>